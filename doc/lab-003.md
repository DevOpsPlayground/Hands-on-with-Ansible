[Set Up](doc/SetUp.md) | [Folder Structure](doc/lab-001.md) | [Mysql Role](doc/lab-002.md) | [Apache Role](doc/lab-003.md) | [Ansible Vault](doc/lab-004.md)

LAB2 ~ Creating our Apache role

Now that we have the mysql server configured we will need to create a role for our webserver and its dependencies.

Similar to what we have done before lets go back into the name.apache/tasks folder and open up the main.yml file.

Lets construct a play to install the libraries we need.

- name: install web components
  apt:
    name: "{{ item }}"
    state: present
    update_cache: yes
  with_items:
    - "{{ pythonreq }}"

Here we are going to loop through the packages we want to install. Lets provide our defaults list with the correct packages we need.

pythonreq:
    - apache2
    - libapache2-mod-wsgi
    - python-pip
    - python-virtualenv
    - python-mysqldb
    - git

The list above encompasses the requirements we need to run our flask application. We start off by installing our apache web server. We then add the python libraries we will need to host our app and finally we add git so the web server can grab the latest files from our repository.

Now we have our packages installed we should check that they installed correctly lets use the service module again to ensure apache is running

- name: ensure apache2 started
  service:
    name: apache2
    state: started
    enabled: yes

Also we should ensure that the wsgi mod we stated in our defaults has loaded correctly. We are using a new module for this. The apache2_module.

- name: ensure mod_wsgi enabled
  apache2_module:
    state: present
    name: wsgi
  notify: restart apache2

http://docs.ansible.com/ansible/apache2_module_module.html